<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SupermanStore</title>

<style>
*{box-sizing:border-box;font-family:system-ui}
body{margin:0;background:linear-gradient(180deg,#6b5cff,#7a6df5)}
.container{max-width:420px;margin:auto;padding:14px}
.header,.card,.infoBox{
 background:#fff;border-radius:16px;padding:14px;
 margin-bottom:14px;box-shadow:0 10px 25px rgba(0,0,0,.15)
}
.header{text-align:center;font-weight:800;color:#4f46e5}
.hero{background:#4f46e5;color:#fff;border-radius:18px;padding:18px;text-align:center}
.stock{display:flex;gap:12px}
.stockBox{flex:1;padding:14px;border-radius:16px;text-align:center;color:#fff}
.verified{background:#22c55e}
.normal{background:#6366f1}
.stockBox b{font-size:28px}
.price{margin-top:6px;font-weight:800}
select,input,button{
 width:100%;padding:14px;margin-top:10px;
 border-radius:14px;border:none;font-size:15px
}
input,select{background:#f1f5f9}
button{background:#22c55e;color:#fff;font-weight:800}
.total{text-align:center;font-size:26px;font-weight:900;color:#4f46e5}
.idbox{background:#f8fafc;border-radius:14px;padding:12px;margin-top:10px}
.notice{background:#dcfce7;color:#166534;padding:10px;border-radius:14px;display:none}
.info{display:grid;grid-template-columns:1fr 1fr;gap:12px}
</style>
</head>

<body>
<div class="container">

<div class="header">âš¡ SUPERMANSTORE</div>

<div class="hero">
 <h2>WELCOME TO MY VIP STORE</h2>
 <p>Premium Fresh IDs â€¢ Instant Delivery</p>
</div>

<div id="notice" class="notice"></div>

<div class="card stock">
 <div class="stockBox verified">
  <h3>âœ“ Verified IDs</h3>
  <b id="vStock">0</b>
  <div class="price">â‚¹<span id="vPrice">0</span>/ID</div>
 </div>
 <div class="stockBox normal">
  <h3>Normal IDs</h3>
  <b id="nStock">0</b>
  <div class="price">â‚¹<span id="nPrice">0</span>/ID</div>
 </div>
</div>

<div class="card">
 <select id="type">
  <option value="normal">Normal IDs</option>
  <option value="verified">Verified IDs</option>
 </select>
 <input type="number" id="qty" placeholder="Enter Quantity">
 <div class="total">â‚¹ <span id="total">0</span></div>
 <button onclick="buy()">Buy Now</button>
</div>

<div class="card" id="payment" style="display:none">
 <div class="idbox" style="text-align:center">
  <div id="qr" style="width:220px;height:220px;margin:auto"></div>
  <p>Pay â‚¹<b id="payAmount">0</b><br>to <b id="upi">Loading...</b></p>
 </div>
 <input id="utr" placeholder="Enter 12 Digit UTR" maxlength="12">
 <button onclick="submitPayment()">Submit</button>
</div>

<div class="card" id="delivery" style="display:none">
 <h3>âœ… Delivered IDs</h3>
 <div id="delivered"></div>
</div>

</div>

<!-- SAFE LIBRARIES -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<script>
/* ðŸ”¥ FIREBASE CONFIG (SAFE) */
firebase.initializeApp({
 apiKey:"AIzaSyBsXjaE79VElBzZ6ALJTn3g-SyKWQKN6C8",
 authDomain:"bestseller-28a56.firebaseapp.com",
 databaseURL:"https://bestseller-28a56-default-rtdb.firebaseio.com",
 projectId:"bestseller-28a56"
});

const db=firebase.database();

let prices={verified:0,normal:0};
let finalAmount=0,currentOrder=null;

/* LIVE DATA */
db.ref("settings/pricePerId").on("value",s=>{
 prices.verified=s.val()||0;
 prices.normal=Math.floor(prices.verified/4);
 vPrice.innerText=prices.verified;
 nPrice.innerText=prices.normal;
 calc();
});

db.ref("stock/verified").on("value",s=>vStock.innerText=s.numChildren());
db.ref("stock/normal").on("value",s=>nStock.innerText=s.numChildren());
db.ref("settings/upi").on("value",s=>upi.innerText=s.val()||"");

qty.oninput=calc;
type.onchange=calc;

function calc(){
 finalAmount=(qty.value||0)*(prices[type.value]||0);
 total.innerText=finalAmount;
}

function buy(){
 if(finalAmount<=0) return alert("Invalid Quantity");

 currentOrder=db.ref("orders").push({
  qty:+qty.value,
  type:type.value,
  amount:finalAmount,
  status:"pending",
  time:Date.now()
 }).key;

 payment.style.display="block";
 generateQR();
}

function generateQR(){
 qr.innerHTML="";
 payAmount.innerText=finalAmount;

 new QRCode(qr,{
  text:`upi://pay?pa=${upi.innerText}&pn=SupermanStore&am=${finalAmount}&cu=INR`,
  width:220,height:220,correctLevel:QRCode.CorrectLevel.H
 });

 setTimeout(()=>{
  const canvas=qr.querySelector("canvas");
  if(!canvas) return;
  const ctx=canvas.getContext("2d");
  const img=new Image();
  img.src="bharatpe.png";
  img.onload=()=>{
   const s=48,x=(220-s)/2,y=(220-s)/2;
   ctx.fillStyle="#fff";
   ctx.fillRect(x-6,y-6,s+12,s+12);
   ctx.drawImage(img,x,y,s,s);
  }
 },300);
}

function submitPayment(){
 if(!/^[0-9]{12}$/.test(utr.value)) return alert("UTR must be 12 digits");
 db.ref("orders/"+currentOrder+"/payment").set({
  utr:utr.value,amount:finalAmount,time:Date.now()
 });
 alert("Payment submitted, wait for admin");
}
</script>

</body>
</html>
